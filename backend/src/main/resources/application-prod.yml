# Spring Boot Production Configuration for Amazon DocumentDB
# BatchID: 20251027-EY
# Group: group3

server:
  port: 8080
  error:
    include-message: always
    include-binding-errors: always

spring:
  # Amazon DocumentDB Configuration
  data:
    mongodb:
      uri: ${SPRING_DATA_MONGODB_URI}
      database: ${SPRING_DATA_MONGODB_DATABASE:hotel_reservation}
      # SSL/TLS Configuration for DocumentDB
      ssl:
        enabled: true
      # Connection pool settings (optimized for DocumentDB)
      min-connections-per-host: 10
      max-connections-per-host: 50
      threads-allowed-to-block-for-connection-multiplier: 5
      connect-timeout: 10000
      socket-timeout: 10000
      max-wait-time: 10000
      server-selection-timeout: 30000
      # DocumentDB specific settings
      # Note: retryWrites must be false for DocumentDB compatibility
      retry-writes: false
      retry-reads: true
      # Disable auto-index creation for DocumentDB (create indexes manually)
      auto-index-creation: false
  
  # Production optimizations
  devtools:
    restart:
      enabled: false
  jpa:
    show-sql: false

# JWT Configuration
jwt:
  secret: ${JWT_SECRET}
  expiration: ${JWT_EXPIRATION:86400000}

# CORS Configuration
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:*}

# Actuator for health checks
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized
  health:
    mongo:
      enabled: true
  metrics:
    export:
      cloudwatch:
        enabled: true
        namespace: HotelReservation

# Logging Configuration
logging:
  level:
    root: ${LOGGING_LEVEL_ROOT:INFO}
    com.hotel: ${LOGGING_LEVEL_COM_HOTEL:INFO}
    org.springframework.data.mongodb: ${LOGGING_LEVEL_MONGODB:DEBUG}
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
  file:
    name: /var/log/hotel-reservation/application.log
    max-size: 10MB
    max-history: 30

